<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/cadastro.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <title>Corinthiano de Coração</title>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="navbar">
                <div class="logo">
                    <img src="assets/imgs/Escudo_Corinthians.png" alt="">
                </div>
                <div class="opcoes">
                    <a class="opcao" href="index.html">Home</a>
                    <a class="opcao" href="#sobre-mim">Sobre Mim</a>
                    <a class="opcao" href="historia_corinthians.html">História do Corinthians</a>
                </div>
            </div>
            <div class="botoes">
                <button onclick="window.location.href='login.html'">Login</button>
                <button onclick="window.location.href='cadastro.html'">Cadastro</button>
            </div>
        </div>
    </header>
    <div class="card_erro" id="cardErro">
        <span id="mensagem_erro"></span>
      </div>
    <div class="cadastro">
        <img src="assets/videos/beijando-a-camisa-renato-augusto.gif">
        <div class="conteudo_cadastro">
            Nome:
                <input id="input_nome" placeholder="Seu nome">
            Informe seu e-mail:
                <input id="input_email" placeholder="email@email.com">
            Criar senha:
                <input id="input_senha" type="password" placeholder="********">
            Confirme sua senha:
                <input id="input_confirmar_senha" type="password" placeholder="********">
        </div>
        <button class="botao" onclick="cadastrar()">
            Cadastrar
        </button>
      </div>
      
    </div> 
</body>
</html>

<script>

    var maiuscula = /[A-Z]/
    var minuscula = /[a-z]/
    var simbolo = /[!@#$]/
    var numerico = /[0-9]/
    var senhaForte = false

    function cadastrar() {
    
    //Recupere o valor da nova input pelo nome do id
    // Agora vá para o método fetch logo abaixo
    var nomeVar = input_nome.value;
    var emailVar = input_email.value;
    var senhaVar = input_senha.value;
    var confirmacaoSenhaVar = input_confirmar_senha.value;
    var idUsuarioVincular

    var temMaiuscula = maiuscula.test(senhaVar)
    var temMinuscula = minuscula.test(senhaVar)
    var temSimbolo = simbolo.test(senhaVar)
    var temNumerico = numerico.test(senhaVar)
    var temTamanho = senhaVar.length >= 8

    const senhaForte = temMaiuscula &&
                 temMinuscula &&
                 temSimbolo   &&
                 temNumerico  &&
                 temTamanho

                 if (nomeVar == "" ||
        emailVar == "" ||
        senhaVar == "" ||
        confirmacaoSenhaVar == ""){
          Swal.fire({
            icon: "error",
            title: "Oops...",
            text: "Preencha todos campos para prosseguir!", 
            color: "#50080b"
          });
    } else if (senhaVar != confirmacaoSenhaVar) {
      Swal.fire({
        icon: "error",
        title: "Oops...",
        text: "Senhas digitadas não conferem!",
        color: "#50080b"
      });
      
    } else if (senhaForte == false){
      Swal.fire({
        icon: "error",
        title: "Oops...",
        text: "Senha fraca, necessita de 8 caracteres, 1 maiúscula, 1 minuscula, um número e um caracter especial!",
        color: "#50080b"
      });
    } else {
        Swal.fire({
        title: "Sucesso!",
        text: "Usuário cadastrado!!",
        icon: "success"
        });

        window.location = "login.html";
    
    // Enviando o valor da nova input
    fetch("/usuarios/cadastrar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        // crie um atributo que recebe o valor recuperado aqui
        // Agora vá para o arquivo routes/usuario.js
        nomeServer: nomeVar,
        emailServer: emailVar,
        senhaServer: senhaVar,
        idUsuarioServer: idUsuarioVincular
      }),
    })

  }

   }

</script>